<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yadhu Kartha">
<meta name="author" content="Felix J. Herrmann">
<meta name="description" content="Domain transfer using Condtional normalizing flows on Shot records.">

<title>Domain transfer on Shot records</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="abstract_files/libs/clipboard/clipboard.min.js"></script>
<script src="abstract_files/libs/quarto-html/quarto.js"></script>
<script src="abstract_files/libs/quarto-html/popper.min.js"></script>
<script src="abstract_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="abstract_files/libs/quarto-html/anchor.min.js"></script>
<link href="abstract_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="abstract_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="abstract_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="abstract_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="abstract_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Domain transfer on Shot records</h1>
</div>

<div>
  <div class="description">
    <p>Domain transfer using Condtional normalizing flows on Shot records.</p>
  </div>
</div>

<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://mloubout.github.io">Yadhu Kartha</a> </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://slim.gatech.edu/">
            Georgia Institute of Technology
            </a>
          </p>
      </div>
      <div class="quarto-title-meta-contents">
    <p class="author">Felix J. Herrmann <a href="https://orcid.org/0000-0003-1180-2167" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://slim.gatech.edu/">
            Georgia Institute of Technology
            </a>
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    <p>code reproducible at <a href="https://github.com/YadhuKartha686/Domain_transfer/blob/main/scripts/DTwithCNF.jl">here</a></p>
  </div>
</div>

</header>

<div class="hidden">
<p><span class="math display">\[
    \newcommand{\pluseq}{\mathrel{+}=}
\]</span></p>
</div>
<section id="objectives-and-scope" class="level2">
<h2 class="anchored" data-anchor-id="objectives-and-scope">Objectives and scope</h2>
<p>The primary objective would be to develop or adapt a method for transferring knowledge from acoustic shot records that contain density information to those that do not and vice versa. This involves understanding the underlying physics and how density variations affect acoustic responses. The scope includes collecting and preparing datasets of acoustic shot records, both with and without density information.</p>
</section>
<section id="method" class="level2">
<h2 class="anchored" data-anchor-id="method">Method</h2>
<p>This methodology delineates a sophisticated approach for the domain transfer from acoustic shot records possessing density information to those devoid of it and vice versa.</p>
<p>Data for the training phase is created by choosing slices of the BGCompass model and placing sources and receivers are the top. The source frequency is 25 Hz. The shot record created by the center source is chosen as the dataset. I used 3 sources and receivers are placed along the top of the model at each pixel. I use non linear modelling for better clarity and realism in the shot records</p>
<p>In the training phase, an alternating methodology is employed to diligently train both the discriminator and the generator. Notably, the adoption of a Conditional Normalizing Flow network as the generator is a strategic choice, motivated by its computational efficiency. Unlike conventional Generative Adversarial Networks (GANs) that are not invertible and require separate networks for each direction of transfer. The networks are trained using an adversarial loss<span class="citation" data-cites="Dreher_2023">(<a href="#ref-Dreher_2023" role="doc-biblioref">Dreher et al. 2023</a>)</span> and the generator is validated at each epoch. The shot records along with their condtions are use as inputs to the network. In this way the network learns to differentiate the shot records based on the conditions. During generation, we pass a shot record through the network indicating the domain it belongs to and ask the network to transfer this input to the other domain. In previous work, we needed two different GAN networks for the bidirectional map of the domains, we elimnate this by using a memory efficient conditional normaliziing flow network.</p>
<div id="fig-vdtov" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/trainingreg.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Thia is a schematic diagram of the training regime. The red lines indicate forward pass through the conditional normalizing flow (CNF) and the green lines indicate the inverse or generation pass. Label 1 and Label 2 are the condtions for the respective domains, as you can notice here, the forward pass latent space is used for domain transfer, essentially transferring the input image to the other domain</figcaption>
</figure>
</div>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<p>We apply the proposed domain transfer approach to a previously unseen shot record. Results for the learned network on these test shot record are presented in Figures 1 and 2, respectively. For reference, the original shot data are included on the left, followed by the domain transferred shot record on the right. Figure 1 shows that the domain transferred shot record has dimmer events in the body and the waves are sligtly thinner as expected of a velocity only shot record. Figure 2 shows that the domain transferred shot record has brighter and sharper events compared to the test shot record, which is expected from the shot record which consists of velocity and density</p>
<div id="fig-vdtov" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/comparetestveldenandvel.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Test shot record data vs domain transferred shot record. Left columnn consists of test shot record consisting of velocity and density and right column consists of domain transferred shot record of this test shot record to only velocity domain.</figcaption>
</figure>
</div>
<div id="fig-vtovd" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/comparetestvelandvelden.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Test shot record data vs domain transferred shot record. Left columnn consists of test shot record consisting of velocity and right column consists of domain transferred shot record of this test shot record to velocity and density domain.</figcaption>
</figure>
</div>
<div id="fig-test" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/testdatacomp.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Test shot record of one domain vs test shot record of second domain. Left column represents test shot record of velcity only shot record and right column consists of velocity and density shot record.</figcaption>
</figure>
</div>
</section>
<section id="significance" class="level2">
<h2 class="anchored" data-anchor-id="significance">Significance</h2>
<p>The introduction of Conditional Normalizing Flow networks as a cornerstone technology underscores a strategic move towards computational efficiency and reduced processing times, making the handling of voluminous datasets more feasible. This not only paves the way for cost-effective exploration activities by obviating the need for expensive field measurements but also democratizes access to sophisticated subsurface exploration tools, thereby expanding the horizons of geophysical research.</p>
<p>This method can be applied to two domains which have a similar property, one of these domains can be expensive or quite hard to obtain whereas the other domain is readily avaiable. This method provides a bidirectional effective mapping between these domains. For example, we can map acoustic shot records to elastic and vice versa. Since elastic shot records are expensive to produce, by employing this method, we can produce elastic shot records from acoustic shot records.</p>
</section>
<section id="discussion-and-conclusions" class="level2">
<h2 class="anchored" data-anchor-id="discussion-and-conclusions">Discussion and conclusions</h2>
<p>We introduced Domain transfer method that provides high accuracy generative samples with low computational cost. We trained a conditional normalizing flow that learns the map between the two domains of interests.We showed that the generated images are consistent with the charactertics of the domain. We also showed that the computation cost of training and inference is low compared to previous work since we are utilizing one network for bidirectional mapping.<span class="citation" data-cites="10.1190/geo2022-0247.1">(<a href="#ref-10.1190/geo2022-0247.1" role="doc-biblioref">Yao, Guasch, and Warner 2023</a>)</span></p>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Dreher_2023" class="csl-entry" role="listitem">
Dreher, Kris K., Leonardo Ayala, Melanie Schellenberg, Marco Hübner, Jan-Hinrich Nölke, Tim J. Adler, Silvia Seidlitz, et al. 2023. <span>“Unsupervised Domain Transfer with&nbsp;Conditional Invertible Neural Networks.”</span> In <em>Medical Image Computing and Computer Assisted Intervention – MICCAI 2023</em>, 770–80. Springer Nature Switzerland. <a href="https://doi.org/10.1007/978-3-031-43907-0_73">https://doi.org/10.1007/978-3-031-43907-0_73</a>.
</div>
<div id="ref-10.1190/geo2022-0247.1" class="csl-entry" role="listitem">
Yao, Jiashun, Lluis Guasch, and Michael Warner. 2023. <span>“<span class="nocase">Neural networks as a tool for domain translation of geophysical data</span>.”</span> <em>Geophysics</em> 88 (3): V267–75. <a href="https://doi.org/10.1190/geo2022-0247.1">https://doi.org/10.1190/geo2022-0247.1</a>.
</div>
</div>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="acknowledgement" class="level2 appendix"><h2 class="anchored quarto-appendix-heading">Acknowledgement</h2><div class="quarto-appendix-contents">

<p>This research was carried out with the support of Georgia Research Alliance and partners of the ML4Seismic Center.</p>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>